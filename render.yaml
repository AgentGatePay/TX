# Render Blueprint for AgentGatePay Transaction Signing Service v4.0
#
# This service signs transactions for AgentGatePay with mandatory commission enforcement.
# Commission config is fetched from AgentGatePay (server-controlled, not client-controlled).
#
# ðŸš€ ONE-CLICK DEPLOY:
# Click the "Deploy to Render" button and you'll be prompted to enter 2 values:
# 1. Your AgentGatePay API Key (pk_live_...)
# 2. Your Wallet Private Key (0x...)
#
# SECURITY FEATURES:
# - Both secrets stored as Secret Files (encrypted, not in logs)
# - Owner API key verification (only specific user can access)
# - Commission config fetched from AgentGatePay API (hardcoded URL)
# - Client CANNOT bypass commission enforcement

services:
  - type: web
    name: agentgatepay-tx-signer
    env: node
    region: oregon  # or any other region
    plan: free      # Free tier available
    buildCommand: npm install
    startCommand: node index.js

    # Environment Variables (optional RPC endpoints)
    envVars:
      # Optional: Custom RPC endpoints (defaults provided)
      - key: BASE_RPC
        value: https://mainnet.base.org
      - key: ETHEREUM_RPC
        value: https://cloudflare-eth.com
      - key: POLYGON_RPC
        value: https://polygon-rpc.com
      - key: ARBITRUM_RPC
        value: https://arb1.arbitrum.io/rpc

    # ðŸ”’ SECRET FILES (Set during one-click deploy!)
    # Both secrets are stored as Secret Files for maximum security
    secretFiles:
      # 1. AgentGatePay API Key
      # Get this from: https://api.agentgatepay.com/v1/users/signup
      # Format: pk_live_abc123def456...
      - path: /etc/secrets/agentgatepay-api-key
        sync: false

      # 2. Wallet Private Key
      # Your wallet private key for signing transactions
      # Format: 0x followed by 64 hex characters (66 total)
      - path: /etc/secrets/wallet-private-key
        sync: false

    # Health check
    healthCheckPath: /health

    # Auto-deploy on push
    autoDeploy: true
